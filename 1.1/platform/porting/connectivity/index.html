<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon"  href="/favicon.ico" />
<title>Connectivity</title>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<base id="baseURL" href="/1.1/" />
<meta id="docsVersion" content="1.1" />
<meta name="last-modified" content="2019-12-08 16:15:09 +0530" />
<meta http-equiv="cache-control" content="max-age=24" />
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="Cache-Control" content="no-store" />
<meta http-equiv="pragma" content="no-cache" />
<meta http-equiv="Expires" content="600" />

<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/bootstrap.min.css">
<link rel="stylesheet" href="/css/pygments/perldoc.css">
<link rel="stylesheet" href="/css/style.css?v=08122019">
<link rel="stylesheet" href="/css/github.css?v=08122019">


</head>
<body class=" latestVersion">
	 <header>
    <div class="header">
        <nav class="nav-secondary-tabs affix" >
            <div class="container-fluid">
                <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
                    <div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <a class="logo" href="/" title="Tizen Documentation">
        Tizen
    </a>
    <div id="tabs">
        
        
        <ul class="tabs" id="jsTOCHorizontal">
            <li class="active">
                <a href="platform/about/tizen-open-source-overview">Platform</a>
            </li>
            <li class="">
                <a href="application/">Application</a>
            </li>
            <li class="">
                <a href="iot/">IoT</a>
            </li>
            <li class="">
                <a href="tizenstudio/">Tizen Studio</a>
            </li>
        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="widgetVersionSwitcher"></div>
    </div>
    <div class="search-form">
        <form action="search.html">
            <input class="search-field form-control ds-input st-search-input" value="" name="q" placeholder="Search the docs" type="search" autocomplete="off" spellcheck="false" dir="auto">
            <button type="submit" class="search-button">
                <i class="fa fa-search"></i>
            </button>
        </form>
    </div>
    
</div>

                </div>
            </div>
        </nav>
    </div>
</header>
    <div class="wrapper right-open">
		<div class="container-fluid">
			<div class="row">
				<div class="col-body">
					<main class="col-content content">
						<section class="section">
							<nav class="breadcrumbs bootstrap hidden-sm-down">
   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

       
          
      
      <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
         <a property="item" typeof="WebPage" href="/">
            <span property="name">Tizen Documentation</span>
            <meta property="position" content="1" />
         </a>
      </li>
       
          
      
      <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
         <a property="item" typeof="WebPage" href="/platform/">
            <span property="name">Platform</span>
            <meta property="position" content="2" />
         </a>
      </li>
       
          
      
      <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
         <span property="name">Connectivity</span>
         <meta property="position" content="3" />
      </li>
      

   </ol>
</nav>



<!-- This is an example of CSS. Maybe you want to implement the css code into your main css file or modify it as you want -->
<style>
   nav.breadcrumbs.bootstrap {
      /* from Twitter Bootstrap 4 */
      /* If you already use Twitter, you do not need these css lines above, cause they already in Twitter Bootstrap */
      /* Additions: image integration */
   }

   nav.breadcrumbs.bootstrap ol {
      margin-left: 0
   }

   nav.breadcrumbs.bootstrap .breadcrumb {
      font-size: 1rem;
      padding: 0.75rem 1rem;
      margin-bottom: 1rem;
      list-style: none;
      background-color: #f1f2ed;
      border-radius: 0.25rem;
   }

   nav.breadcrumbs.bootstrap .breadcrumb::after {
      content: "";
      display: table;
      clear: both;
   }

   nav.breadcrumbs.bootstrap .breadcrumb-item {
      float: left;
   }

   nav.breadcrumbs.bootstrap .breadcrumb-item+.breadcrumb-item::before {
      display: inline-block;
      padding-right: 0.5rem;
      padding-left: 0.5rem;
      color: #818a91;
      content: "/";
   }

   nav.breadcrumbs.bootstrap .breadcrumb-item+.breadcrumb-item:hover::before {
      text-decoration: underline;
   }

   nav.breadcrumbs.bootstrap .breadcrumb-item+.breadcrumb-item:hover::before {
      text-decoration: none;
   }

   nav.breadcrumbs.bootstrap .breadcrumb-item-active {
      color: #818a91;
   }

   nav.breadcrumbs.bootstrap .breadcrumb .icon {
      display: inline-block;
   }

   nav.breadcrumbs.bootstrap .breadcrumb .icon svg {
      height: 0.8rem;
      width: 0.8rem;
   }
</style>

							<div class="widgetLatestVersionNotification"></div>
							<h1 id="connectivity">Connectivity</h1>

<p>You can implement various connectivity features, such as Bluetooth, WLAN, and NFC.</p>

<h2 id="bluetooth">Bluetooth</h2>

<p>Bluetooth is a short range communication protocol used to communicate between 2 devices. Tizen uses open source Bluetooth components, such as BlueZ and ObexD. Bluez and ObexD run as a daemon and an interface library, Bluetooth Framework, is used for applications to access them over the D-Bus interface.</p>

<p>This section explains the Bluetooth architecture on the Tizen platform and how Tizen can be ported, along with the configuration parameters and their values.</p>

<p><strong>Figure: Tizen Bluetooth architecture</strong></p>

<p><img src="media/800px-bluetooth.png" alt="Tizen Bluetooth architecture" /></p>

<p>The Bluetooth framework provides a dialogue for the user to control the BlueZ, ObexD, and PulseAudio daemons. Bluetooth provides a standard interface between the Bluetooth chip and AP, called the HCI (Host Controller Interface). HCI can be implemented on USB, UART, and SDIO, but for the mobile environment, UART is the most common. HCI activation can differ depending on the chip vendor. The vendor provides the HCI configuration and the initial scripts. For example, Broadcom and Spreadtrum provide firmware and a loading tool. Tizen supports Bluetooth version 4.2, and the GATT, FTP, OPP, MAP, PBAP, A2DP, AVRCP, HSP/HFP, RFCOMM, HID, HDP, and PAN profiles. Bluetooth Low Energy functions have been implemented in BlueZ and <code class="highlighter-rouge">bluetooth-frwk</code>.</p>

<p>The Tizen Bluetooth framework is based on the open source BlueZ project. BlueZ provides the DBUS API and based on it, Tizen Bluetooth framework provides the C Language API. Using the Tizen Bluetooth framework is recommended.</p>

<p>The following components are necessary for Bluetooth:</p>

<ul>
  <li>Application
    <ul>
      <li>User dialogue that controls the BlueZ, ObexD, and PulseAudio daemons</li>
    </ul>
  </li>
  <li>ObexD
    <ul>
      <li>Open source component</li>
      <li>Object exchange daemon</li>
      <li>Supports OPP, FTP, PBAP, SYNC, and MAP profile stack</li>
    </ul>
  </li>
  <li>BluetoothD
    <ul>
      <li>BluetoothD is the open source component, BlueZ 5.37 is supported</li>
      <li>Bluetooth central daemon</li>
      <li>Supports GAP, SDP, A2DP, AVRCP, HFP, HSP, and GATT profile stack</li>
    </ul>
  </li>
  <li>Bluetooth subsystem
    <ul>
      <li>Provides the BT unix socket. Each protocol can be accessed by its socket.</li>
      <li>Supports the L2CAP, RFCOMM, SCO, and HCI protocols</li>
    </ul>
  </li>
  <li>Bluetooth driver
    <ul>
      <li>BT Chip driver</li>
      <li>For UART, the interface is provided by the <a href="https://wiki.tizen.org/Linux">Linux</a> kernel.</li>
      <li>GPIO configuration, <code class="highlighter-rouge">rfkill</code> (radio frequency management), and power management can be handled by both the vendor and the porting engineer</li>
    </ul>
  </li>
  <li>Bluetooth firmware loading module
    <ul>
      <li>Depending on the environment, it loads the Bluetooth firmware to the Bluetooth chip</li>
      <li>Tizen and the chipset vendor need to implement this together</li>
      <li>Package: <code class="highlighter-rouge">bluetooth-tools</code></li>
    </ul>
  </li>
</ul>

<h3 id="porting-the-oal-interface">Porting the OAL Interface</h3>

<p>The following OAL scripts are run during the Bluetooth stack start and end sequences. These scripts invoke the Bluetooth chip-specific (such as Broadcom and Spreadtrum) scripts, provided by the chipset vendor to perform chip-specific configuration. These scripts are available in the <code class="highlighter-rouge">bluetooth-dev-tools.under</code> package. When this package is installed, it copies the following scripts in the <code class="highlighter-rouge">/usr/etc/Bluetooth/</code> directory:</p>

<ul>
  <li><code class="highlighter-rouge">bt-stack-up.sh</code></li>
  <li><code class="highlighter-rouge">bt-stack-down.sh</code></li>
  <li><code class="highlighter-rouge">bt-reset-env.sh</code></li>
</ul>

<h4 id="tizen-bt-obex-profiles">Tizen BT Obex Profiles</h4>

<p>In Tizen, the open source ObexD is used for the <code class="highlighter-rouge">obex</code>-based profiles:</p>

<ul>
  <li>BT Obex profiles server (<code class="highlighter-rouge">obexd</code>)</li>
  <li>BT Obex profiles client (<code class="highlighter-rouge">obex-client</code>)</li>
</ul>

<h3 id="configuration">Configuration</h3>

<p>There are a few configuration changes that need to be made to enable the specific chipset and the scripts and other chipset-specific configuration information, such as UART speed and UART terminal (<code class="highlighter-rouge">tty</code>). These changes must be provided by the chipset vendor.</p>

<ul>
  <li>Configuration for the Broadcomm BCM4358 Bluetooth chipset
    <ul>
      <li><code class="highlighter-rouge">hciattach</code><br />
The <code class="highlighter-rouge">bluez/tools/hciattach.c</code> file is patched to enable the <code class="highlighter-rouge">hciattach</code> tool specific to the BCM4358 chipset. This service attaches the BT UART HCI interface to the Bluetooth stack at a baud rate of 3000000. It is also responsible for loading the Bluetooth firmware on BCM4358.</li>
      <li>Bluetooth UART used is <code class="highlighter-rouge">/dev/ttySAC3</code></li>
      <li>Broadcom firmware used is <code class="highlighter-rouge">BCM4358A1_001.002.005.0032.0066.hcd</code></li>
      <li>UART speed configuration for BCM4358A1 is 3000000</li>
      <li><code class="highlighter-rouge">bcmtool</code> used is <code class="highlighter-rouge">bcmtool_4358a1</code></li>
      <li><code class="highlighter-rouge">.bd_addr</code> contains the unique Bluetooth address, which is generated during the first Bluetooth activation</li>
      <li>Register the Bluetooth device:
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bcmtool_4358a1 /dev/ttySAC0 -FILE=BCM4358A1_001.002.005.0032.0066.hcd -BAUD=3000000 -ADDR=/csa/bluetooth/.bd_addr -SETSCO=0,0,0,0,0,0,0,3,3,0 -LP
</code></pre></div>        </div>
      </li>
      <li>Attach a serial device to the Bluetooth stack using the UART HCI for a Broadcomm device:
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hciattach /dev/ttySAC3 -S 3000000 bcm2035 3000000 flow
</code></pre></div>        </div>
      </li>
      <li>Run the Bluetooth daemon version 5.37:
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bluetoothd
</code></pre></div>        </div>
      </li>
      <li>Bring the device up, set up the device name, and enable the SSP mode:
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hciconfig hci0 up
hciconfig hci0 name "Tizen-Mobile"
hciconfig hci0 sspmode 1
</code></pre></div>        </div>
      </li>
      <li>Switch on the Bluetooth radio:
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rfkill unblock bluetooth
</code></pre></div>        </div>
      </li>
      <li>Switch off the Bluetooth radio:
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rfkill block bluetooth
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>Configuration for the Spreadtrum sc2331 Bluetooth chipset
    <ul>
      <li><code class="highlighter-rouge">hciattach</code><br />
The <code class="highlighter-rouge">bluez/tools/hciattach.c</code> file is patched to enable the <code class="highlighter-rouge">hciattach</code> tool specific to the sc2331 chipset. This service attaches the BT UART HCI interface to the Bluetooth stack at a baud rate of 3000000. It is also responsible for loading the Bluetooth firmware on sc2331.</li>
      <li>Register the Bluetooth device:<br />
The <code class="highlighter-rouge">cp2-download</code> tool is provided for downloading the Spreadtrum firmware. This tool also downloads the Wi-Fi firmware at boot time.</li>
      <li>Install the following files in the target’s <code class="highlighter-rouge">/usr/lib/firmware</code> directory:
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sc2331_fdl.bin
sc2331_fw.bin
scx35_pikeavivaltove_3M_MARLIN_connectivity_calibration.ini
scx35_pikeavivaltove_3M_MARLIN_connectivity_configure.ini
</code></pre></div>        </div>
      </li>
      <li>Bluetooth UART used is <code class="highlighter-rouge">/dev/ttyS0</code></li>
      <li>UART speed configuration for sc233 is 3000000</li>
      <li>Attach a serial device to the Bluetooth stack using the UART HCI:
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hciattach -s 3000000 /dev/ttyS0 sprd 3000000 flow
</code></pre></div>        </div>
      </li>
      <li>Run the bluetooth daemon version 5.37:
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bluetoothd
</code></pre></div>        </div>
      </li>
      <li>Bring the device up, set up the device name, and enable the SSP mode:
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hciconfig hci0 up
hciconfig hci0 name "Tizen-Mobile"
hciconfig hci0 sspmode 1
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>

<h3 id="references">References</h3>

<p>Open source component version: BlueZ 5.37</p>

<p>For more information, see <a href="http://www.bluez.org/">http://www.bluez.org/</a>.</p>

<p>The reference kernel configuration for Bluetooth:</p>

<ul>
  <li>The following kernel <code class="highlighter-rouge">.config</code> lines are enabled for Broadcom Bluetooth support:
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CONFIG_BT=y
CONFIG_BT_L2CAP=y
CONFIG_BT_RFCOMM=y
CONFIG_BT_RFCOMM_TTY=y
CONFIG_BT_BNEP=y
CONFIG_BT_HIDP=y
CONFIG_BT_HCIUART=y
CONFIG_BT_HCIUART_H4=y
CONFIG_BCM4330=y
CONFIG_RFKILL=y
CONFIG_RFKILL_INPUT=y
CONFIG_RXTRA_FIRMWARE_BCM4330="BCM4330.hcd"
</code></pre></div>    </div>
  </li>
  <li>The following kernel <code class="highlighter-rouge">.config</code> lines are enabled for Bluetooth AVRCP support:
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CONFIG_INPUT_MISC=y
CONFIG_INPUT_UINPUT=y
</code></pre></div>    </div>
  </li>
  <li>The following kernel <code class="highlighter-rouge">.config</code> lines are enabled for Bluetooth HID support:
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CONFIG_INPUT_GP2A=y
CONFIG_INPUT_KR3DH=y
</code></pre></div>    </div>
  </li>
  <li>The following kernel <code class="highlighter-rouge">.config</code> lines are enabled for Bluetooth Audio (SCO-over-PCM) support:
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CONFIG_BT_SCO=y
CONFIG_INPUT_GP2A=y
CONFIG_INPUT_KR3DH=y
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="wlan">WLAN</h2>

<p>This section provides a step-by-step explanation of what is involved in adding a new Wi-Fi driver and making Wi-Fi work.</p>

<p><strong>Figure: Tizen Wi-FI architecture</strong></p>

<p><img src="media/785px-wlan.png" alt="Tizen Wi-FI architecture" /></p>

<p>Feature overview:</p>

<ul>
  <li>WLAN (802.11 b/g/n)</li>
  <li>WPS PBC</li>
  <li>EAP (PEAP, TTLS)</li>
</ul>

<p>Tizen uses <code class="highlighter-rouge">wpa_supplicant</code> as the platform interface to Wi-Fi devices. Your Wi-Fi driver must be compatible with the standard <code class="highlighter-rouge">wpa_supplicant</code>.</p>

<p>The Tizen WLAN architecture is centered on the Linux wireless (IEEE-802.11) subsystem. The Linux wireless SW stack defines the WLAN hardware adaptation software interfaces that need to be used in Tizen. In practice, the required interfaces are defined by cfg80211 for FullMAC WLAN devices and by mac80211 for SoftMAC WLAN devices. In addition, a Linux network interface needs to be supported towards the Linux TCP/IP stack.</p>

<p>The Connection Manager (ConnMan) is a daemon for managing Internet connections within embedded devices running the Linux operating system.</p>

<p>The <code class="highlighter-rouge">wpa_supplicant</code> interface is a WPA Supplicant with support for WPA and WPA2 (IEEE 802.11i / RSN). WPA Supplicant is the IEEE 802.1X/WPA component that is used in the client stations. It implements key negotiation with a WPA Authenticator and it controls roaming and the IEEE 802.11 authentication/association of the WLAN driver.</p>

<h3 id="porting-the-oal-interface-1">Porting the OAL Interface</h3>

<p>The WLAN driver plugin is specific to a Wi-Fi chipset. This includes firmware and chipset-specific tools. Wi-Fi chipset firmware and tool files must be copied to the WLAN driver plugin directory, built, and installed before testing the Wi-Fi functionality. Because of Tizen platform requirements, the Wi-Fi driver must create the <code class="highlighter-rouge">/opt/etc/.mac.info</code> file, which has the device MAC address.</p>

<p>The WLAN driver plugin contains the <code class="highlighter-rouge">wlan.sh</code> file (located in <code class="highlighter-rouge">/usr/bin/wlan.sh</code>), which is used to load or unload the Wi-Fi driver firmware.</p>

<p>When the <code class="highlighter-rouge">wifi_activate()</code> function is called, the load driver request is sent to the NET-CONFIG daemon. The NET-CONFIG daemon loads the Wi-Fi driver using the <code class="highlighter-rouge">wlan.sh</code> script file. Similarly, the <code class="highlighter-rouge">wifi_deactivate()</code> function requests unloading of the Wi-Fi driver. In case of Wi-Fi Direct®, the <code class="highlighter-rouge">wifi_direct_activate()</code> and <code class="highlighter-rouge">wifi_direct_deactivate()</code> functions make the Wi-Fi Direct manager load or unload the Wi-Fi driver using the <code class="highlighter-rouge">wlan.sh</code> script.</p>

<p>Using the <code class="highlighter-rouge">/usr/bin/wlan.sh</code> script:</p>

<ul>
  <li><code class="highlighter-rouge">wlan.sh start</code>: Power up the Wi-Fi driver in station mode by loading the driver and running the firmware file.</li>
  <li><code class="highlighter-rouge">wlan.sh p2p</code>: Power up the Wi-Fi driver in Wi-Fi Direct mode by loading the driver and running the firmware file.</li>
  <li><code class="highlighter-rouge">wlan.sh softap</code>: Power up the Wi-Fi driver in Soft AP mode by loading the driver and running the firmware file.</li>
  <li><code class="highlighter-rouge">wlan.sh stop</code>: Power down the Wi-Fi driver.</li>
</ul>

<p>All other Wi-Fi related functionality is handled by the ConnMan daemon.</p>

<h3 id="references-1">References</h3>

<ul>
  <li>Connection Manager (ConnMan) project website: <a href="https://01.org/connman">https://01.org/connman</a></li>
  <li>Linux wireless (IEEE-802.11) subsystem: <a href="https://wireless.wiki.kernel.org">https://wireless.wiki.kernel.org</a></li>
  <li>Information on Linux WPA/WPA2/IEEE 802.1X Supplicant: <a href="http://hostap.epitest.fi/wpa_supplicant/">http://hostap.epitest.fi/wpa_supplicant/</a></li>
  <li>Latest ConnMan release: <a href="http://git.kernel.org/?p=network/connman/connman.git;a=summary">http://git.kernel.org/?p=network/connman/connman.git;a=summary</a></li>
  <li>WLAN driver plugin Git path: <code class="highlighter-rouge">/adaptation/devices/wlandrv-plugin-tizen-bcm43xx</code></li>
  <li>Reference kernel configurations</li>
  <li>The following options must be enabled if the driver supports the cfg802.11 configuration API, instead of the wireless extension API. For more information, see <a href="http://linuxwireless.org/">http://linuxwireless.org</a>.
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CONFIG_CFG80211
CONFIG_LIB80211
CONFIG_MAC80211 (Enable this flag, if the driver supports the softMAC feature)
</code></pre></div>    </div>
  </li>
  <li>The following configuration options must be enabled in the kernel if the driver supports wireless extension APIs:
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CONFIG_WIRELESS_EXT=y
CONFIG_WEXT_CORE=y
CONFIG_WEXT_PROC=y
CONFIG_WEXT_PRIV=y
CONFIG_WEXT_SPY=y
CONFIG_WIRELESS_EXT_SYSFS=y
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="nfc">NFC</h2>

<p>The NFC application enables the user to:</p>
<ul>
  <li>Read and import the content written on an NFC tag.</li>
  <li>Edit the content written on an NFC tag.</li>
  <li>Write and save data on an NFC tag.</li>
  <li>Load and save the NFC data from or in a file.</li>
</ul>

<p><strong>Figure: NFC architecture</strong></p>

<p><img src="media/nfc.png" alt="NFC architecture" /></p>

<p>The NFC implementation has the following main components:</p>

<ul>
  <li><strong>NFC client</strong> acts as an interface between the NFC application and the NFC manager, while writing or editing tag information in any physical tag.</li>
  <li><strong>NFC manager</strong> is the main interface, which actually deals with NFC physical tags, creates a connection with tags, and detects it. It is a daemon process to control the NFC chipset (such as NXP pn544). It provides the read and write service and basic P2P communication service, as well as the basic API for the client application.</li>
  <li><strong>NFC stack</strong> contains the required plugin, based on the NFC chipset. Currently, the <code class="highlighter-rouge">nfc-plugin-nxp</code> is used for the NXP chipset. The NFC plugin acts as an interface between the NFC chipset with the NFC framework (<code class="highlighter-rouge">nfc-manager</code>). It must be implemented according to the interface provided by the <code class="highlighter-rouge">nfc-manager</code>.</li>
</ul>

<h3 id="porting-the-oal-interface-2">Porting the OAL Interface</h3>

<p>The NFC plugin is implemented as a shared library and it interfaces the Tizen <code class="highlighter-rouge">nfc-manager</code> and the vendor NFC chip. The NFC manager loads the <code class="highlighter-rouge">libnfc-plugin.so</code> library at runtime from the <code class="highlighter-rouge">/usr/lib/libnfc-plugin.so</code> directory. Any vendor-specific plugin is installed within the same path. The plugin must be written with predefined OAL API interfaces.</p>

<p>During initialization, the <code class="highlighter-rouge">nfc-manager</code> loads the <code class="highlighter-rouge">nfc-plugin.so</code> library, searches for the <code class="highlighter-rouge">onload()</code> function, and calls the function with an interface structure instance as an argument for mapping all the OAL interfaces. These OAL/OEM interfaces are implemented according to the underlying NFC chipset. Once the mapping is done, the NFC manager interacts with <code class="highlighter-rouge">nfc-plugin</code>, which implements the vendor-specific OAL interfaces.</p>

<p>The following example shows the <code class="highlighter-rouge">onload()</code> function:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Bool</span>
<span class="nf">onload</span><span class="p">(</span><span class="n">net_nfc_oem_interface_s</span> <span class="o">*</span><span class="n">oem_interfaces</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">oem_interfaces</span><span class="o">-&gt;</span><span class="n">init</span> <span class="o">=</span> <span class="n">xxx</span><span class="p">;</span>  <span class="cm">/* xxx refers to plugin APIs */</span>
    <span class="n">oem_interfaces</span><span class="o">-&gt;</span><span class="n">deinit</span> <span class="o">=</span> <span class="n">xxx</span><span class="p">;</span>
    <span class="n">oem_interfaces</span><span class="o">-&gt;</span><span class="n">register_listener</span> <span class="o">=</span> <span class="n">xxx</span><span class="p">;</span>
    <span class="n">oem_interfaces</span><span class="o">-&gt;</span><span class="n">unregister_listener</span> <span class="o">=</span> <span class="n">xxx</span><span class="p">;</span>
    <span class="n">oem_interfaces</span><span class="o">-&gt;</span><span class="n">check_firmware_version</span> <span class="o">=</span> <span class="n">xxx</span><span class="p">;</span>

    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The NFC OAL interfaces are defined in the following structure. Use the <code class="highlighter-rouge">net_nfc_oem_controller.h</code> header file.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">typedef</span> <span class="k">struct</span> <span class="n">_net_nfc_oem_interface_s</span> <span class="p">{</span>
    <span class="n">net_nfc_oem_controller_init</span> <span class="n">init</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_deinit</span> <span class="n">deinit</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_register_listener</span> <span class="n">register_listener</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_unregister_listener</span> <span class="n">unregister_listener</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_check_firmware_version</span> <span class="n">check_firmware_version</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_update_firmware</span> <span class="n">update_firmware</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_get_stack_information</span> <span class="n">get_stack_information</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_configure_discovery</span> <span class="n">configure_discovery</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_get_secure_element_list</span> <span class="n">get_secure_element_list</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_set_secure_element_mode</span> <span class="n">set_secure_element_mode</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_connect</span> <span class="n">connect</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_connect</span> <span class="n">disconnect</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_check_ndef</span> <span class="n">check_ndef</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_check_target_presence</span> <span class="n">check_presence</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_read_ndef</span> <span class="n">read_ndef</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_write_ndef</span> <span class="n">write_ndef</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_make_read_only_ndef</span> <span class="n">make_read_only_ndef</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_transceive</span> <span class="n">transceive</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_format_ndef</span> <span class="n">format_ndef</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_exception_handler</span> <span class="n">exception_handler</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_is_ready</span> <span class="n">is_ready</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_config</span> <span class="n">config_llcp</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_check_llcp</span> <span class="n">check_llcp_status</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_activate_llcp</span> <span class="n">activate_llcp</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_create_socket</span> <span class="n">create_llcp_socket</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_bind</span> <span class="n">bind_llcp_socket</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_listen</span> <span class="n">listen_llcp_socket</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_accept</span> <span class="n">accept_llcp_socket</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_connect_by_url</span> <span class="n">connect_llcp_by_url</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_connect</span> <span class="n">connect_llcp</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_disconnect</span> <span class="n">disconnect_llcp</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_socket_close</span> <span class="n">close_llcp_socket</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_recv</span> <span class="n">recv_llcp</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_send</span> <span class="n">send_llcp</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_recv_from</span> <span class="n">recv_from_llcp</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_send_to</span> <span class="n">send_to_llcp</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_reject</span> <span class="n">reject_llcp</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_get_remote_config</span> <span class="n">get_remote_config</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_llcp_get_remote_socket_info</span> <span class="n">get_remote_socket_info</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_sim_test</span> <span class="n">sim_test</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_test_mode_on</span> <span class="n">test_mode_on</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_test_mode_off</span> <span class="n">test_mode_off</span><span class="p">;</span>
    <span class="n">net_nfc_oem_controller_support_nfc</span> <span class="n">support_nfc</span><span class="p">;</span>
<span class="p">}</span> <span class="n">net_nfc_oem_interface_s</span><span class="p">;</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">nfc_oem_interface_s</code> struct is exported in the <code class="highlighter-rouge">nfc-plugin</code>. Using this interface structure, the <code class="highlighter-rouge">nfc-manager</code> communicates with the OAL interfaces at runtime. The NFC plugin loads when the <code class="highlighter-rouge">nfc-manager</code> is started and the plugin <code class="highlighter-rouge">init()</code> function is called to initialize the NFC chip.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">init</span><span class="p">)</span> <span class="p">(</span><span class="n">net_nfc_oem_controller_init</span><span class="o">*</span><span class="p">);</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">nfc-manager</code> issues the <code class="highlighter-rouge">deinit()</code> function to deinitialize the NFC chip:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">deinit</span><span class="p">)</span> <span class="p">(</span><span class="n">net_nfc_oem_controller_deinit</span> <span class="o">*</span><span class="p">);</span>
</code></pre></div></div>

<p>Pay attention to the following:</p>

<ul>
  <li>Sending the notification to the upper layer (NFC service)<br />
See the <code class="highlighter-rouge">phdal4nfc_message_glib.c</code> file. The <code class="highlighter-rouge">g_idle_add_full</code> is used for handling the message in the NFC service. You can use the callback client asynchronously in the client context. Post a message in queue, and the message is processed by a client thread.</li>
  <li>Reference implementation of the NFC plugin<br />
Sample code snippets cannot be reproduced. Code is proprietary. For reference, see the <code class="highlighter-rouge">nfc-plugin-emul</code> and <code class="highlighter-rouge">nfc-plugin-nxp</code> files.</li>
</ul>

<h4 id="nfc-oal-api">NFC OAL API</h4>

<p>The following table lists all the NFC OAL API functions.</p>

<p><strong>Table: NFC OAL API functions</strong></p>

<table>
  <thead>
    <tr>
      <th>Function</th>
      <th>Description</th>
      <th>Parameter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_init init;</code></td>
      <td>Initializes the NFC chip.</td>
      <td><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_deinit deinit;</code></td>
      <td>Deinitializes the NFC chip.</td>
      <td>-</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_register_listener register_listener;</code></td>
      <td>Registers a callback function for a tag event, SE event, and llcp event.</td>
      <td><code class="highlighter-rouge">target_detection_listener_cb target_detection_listener</code>: Tag event callback function<br /><code class="highlighter-rouge">se_transaction_listener_cb se_transaction_listener</code>: SE event callback function<br /><code class="highlighter-rouge">llcp_event_listener_cb llcp_event_listener</code>: llcp event callback function<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_unregister_listener unregister_listener;</code></td>
      <td>Releases a callback function for a tag event, SE event, and llcp event.</td>
      <td>-</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_check_firmware_version check_firmware_version;</code></td>
      <td>Checks the firmware version of the NFC chip.</td>
      <td><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_update_firmware update_firmware;</code></td>
      <td>Updates the NFC chip firmware.</td>
      <td><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_get_stack_information get_stack_information;</code></td>
      <td>Gets the list of supported tags and the current firmware version.</td>
      <td><code class="highlighter-rouge">net_nfc_stack_information_s</code>: Pointer value to get the information of support tags and the current firmware version<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_configure_discovery configure_discovery;</code></td>
      <td>Delivers the config information on discovery.</td>
      <td><code class="highlighter-rouge">net_nfc_discovery_mode_e</code>: Start/stop mode<br /><code class="highlighter-rouge">net_nfc_event_filter_e config</code>: Information for tag filtering<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_get_secure_element_list get_secure_element_list;</code></td>
      <td>Gets the information of the current secure element.</td>
      <td><code class="highlighter-rouge">net_nfc_secure_element_info_s</code>: Pointer value to get secure element information<br /><code class="highlighter-rouge">int</code>: Pointer value to get the count of the secure element<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_set_secure_element_mode set_secure_element_mode;</code></td>
      <td>Sets the secure element to use.</td>
      <td><code class="highlighter-rouge">net_nfc_secure_element_type_e</code>: Secure element information<br /><code class="highlighter-rouge">net_nfc_secure_element_mode_e</code>: Mode information to set<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_connect connect;</code></td>
      <td>Connects to the detected tag/target.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Tag/target handle for connecting<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_connect disconnect;</code></td>
      <td>Disconnects the connected tag/target.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Tag/target handle for disconnecting<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_check_ndef check_ndef;</code></td>
      <td>Checks the tag for ndef support.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Tag handle to check ndef<br /><code class="highlighter-rouge">int</code>: Max size supported in the tag<br /><code class="highlighter-rouge">int</code>: Real data size saved in the tag<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_check_target_presence check_presence;</code></td>
      <td>Checks whether a tag exists in the RF range.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Tag handle to check presence<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_read_ndef read_ndef;</code></td>
      <td>Reads ndef data in a tag.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Tag handle to read<br /><code class="highlighter-rouge">data_s</code>: Pointer value to save the ndef data<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_write_ndef write_ndef;</code></td>
      <td>Writes the data to the tag.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Handle to write<br /><code class="highlighter-rouge">data_s</code>: Data to write<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_make_read_only_ndef make_read_only_ndef;</code></td>
      <td>Makes the tag to a read-only tag.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Target tag handle<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_transceive transceive;</code></td>
      <td>Sends and receives the low command to the tag or target.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Tag or target handle to transceive<br /><code class="highlighter-rouge">net_nfc_transceive_info_s</code>: Pointer value including command or data to send and data to receive<br /><code class="highlighter-rouge">data_s</code>: Pointer value to send the information of context<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_format_ndef format_ndef;</code></td>
      <td>Formats the tag.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Tag handle to format<br /><code class="highlighter-rouge">data_s</code>: Key value to send the tag for formatting<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_exception_handler exception_handler;</code></td>
      <td>When the <code class="highlighter-rouge">nfc-manager</code> faces an unwanted exception, it tries to deinitialize and initialize the stack before unregistering and registering the callback function.</td>
      <td>-</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_is_ready is_ready;</code></td>
      <td>Checks the status of the NFC stack.</td>
      <td><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_config config_llcp;</code></td>
      <td>Sets the llcp configuration (miu, lto, wks, option).</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Target handle to set llcp<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_check_llcp check_llcp_status;</code></td>
      <td>Checks the llcp configuration (miu, lto, wks, option).</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Target handle to check llcp<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_activate_llcp activate_llcp;</code></td>
      <td>Activates the llcp functionality.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Target handle to activate<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_create_socket create_llcp_socket;</code></td>
      <td>Creates the llcp socket.</td>
      <td><code class="highlighter-rouge">net_nfc_llcp_socket_t</code>: Pointer value to receive the socket information<br /><code class="highlighter-rouge">net_nfc_socket_type_e socketType</code>: Type of socket to create<br /><code class="highlighter-rouge">uint16_t miu</code>: miu value<br /><code class="highlighter-rouge">uint8_t rw</code>: rw value<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure<br /><code class="highlighter-rouge">void</code>: value to control the context (can be set to <code class="highlighter-rouge">NULL</code>)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_bind bind_llcp_socket;</code></td>
      <td>Binds the socket.</td>
      <td><code class="highlighter-rouge">net_nfc_llcp_socket_t socket</code>: Information about the socket to bind<br /><code class="highlighter-rouge">uint8_t service_access_point</code>: Information of access point to bind<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_listen listen_llcp_socket;</code></td>
      <td>Sets the socket to listen.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Target handle<br /><code class="highlighter-rouge">uint8_t</code>: Service name to listen<br /><code class="highlighter-rouge">net_nfc_llcp_socket_t socket</code>: Socket information<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure<br /><code class="highlighter-rouge">void</code>: Value to control the context (can be set to <code class="highlighter-rouge">NULL</code>)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_accept accept_llcp_socket;</code></td>
      <td>Accepts the connect request in listening status.</td>
      <td><code class="highlighter-rouge">net_nfc_llcp_socket_t socket</code>: Socket information to accept<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_connect_by_url connect_llcp_by_url;</code></td>
      <td>Connects the server with the service name.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Handle of the target to connect<br /><code class="highlighter-rouge">net_nfc_llcp_socket_t socket</code>: Socket information<br /><code class="highlighter-rouge">uint8_t</code>: Service name to connect<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure<br /><code class="highlighter-rouge">void</code>: Value to control the context (can be set to <code class="highlighter-rouge">NULL</code>)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_connect connect_llcp;</code></td>
      <td>Connects to the server with access point (port number).</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Target handle<br /><code class="highlighter-rouge">net_nfc_llcp_socket_t socket</code>: Socket information<br /><code class="highlighter-rouge">uint8_t service_access_point</code>: Access point number<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure<br /><code class="highlighter-rouge">void</code>: Value to control the context (can be set to <code class="highlighter-rouge">NULL</code>)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_disconnect disconnect_llcp;</code></td>
      <td>Disconnects the llcp link.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Socket information to disconnect<br /><code class="highlighter-rouge">net_nfc_llcp_socket_t socket</code>: Information of the socket to disconnect<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure<br /><code class="highlighter-rouge">void</code>: Value to control the context (can be set to <code class="highlighter-rouge">NULL</code>)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_socket_close close_llcp_socket;</code></td>
      <td>Closes the llcp socket.</td>
      <td><code class="highlighter-rouge">net_nfc_llcp_socket_t socket</code>: Socket information to close<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_recv recv_llcp;</code></td>
      <td>Receives the data using the llcp link.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Target handle to receive<br /><code class="highlighter-rouge">net_nfc_llcp_socket_t socket</code>: Socket information to receive<br /><code class="highlighter-rouge">data_s</code>: Pointer value to receive the data<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure<br /><code class="highlighter-rouge">void</code>: Value to control the context (can be set to <code class="highlighter-rouge">NULL</code>)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_send send_llcp;</code></td>
      <td>Sends the data using llcp link.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Target handle to send<br /><code class="highlighter-rouge">net_nfc_llcp_socket_t socket</code>: Socket information to send<br /><code class="highlighter-rouge">data_s</code>: Data to send<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure<br /><code class="highlighter-rouge">void</code>: Value to control the context (can be set to <code class="highlighter-rouge">NULL</code>)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_recv_from recv_from_llcp;</code></td>
      <td>Rejects the connect request from the client socket.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Target handle to reject<br /><code class="highlighter-rouge">net_nfc_llcp_socket_t socket</code>: Socket information to reject<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_send_to send_to_llcp;</code></td>
      <td>Sends the data using the service access point.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Peer target handle<br /><code class="highlighter-rouge">net_nfc_llcp_socket_t socket</code>: Socket information<br /><code class="highlighter-rouge">data_s</code>: Data to send<br /><code class="highlighter-rouge">uint8_t service_access_point</code>: Service access point to send<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure<br /><code class="highlighter-rouge">void</code>: Value to control the context (can be set to <code class="highlighter-rouge">NULL</code>)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_reject reject_llcp;</code></td>
      <td>Rejects the connect request from the client socket.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Target handle to reject<br /><code class="highlighter-rouge">net_nfc_llcp_socket_t socket</code>: Socket information to reject<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_get_remote_config get_remote_config;</code></td>
      <td>Gets the llcp socket config information of the peer device.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Peer target handle<br /><code class="highlighter-rouge">net_nfc_llcp_config_info_s</code>: Pointer value to get config information of peer device’s llcp socket<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_llcp_get_remote_socket_info get_remote_socket_info;</code></td>
      <td>Gets the llcp socket information of the peer device.</td>
      <td><code class="highlighter-rouge">net_nfc_target_handle_s</code>: Peer target handle<br /><code class="highlighter-rouge">net_nfc_llcp_socket_t socket</code>: llcp socket information<br /><code class="highlighter-rouge">net_nfc_llcp_socket_option_s</code>: Pointer value to save the information of remote socket<br /><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_sim_test sim_test;</code></td>
      <td>Tests the SWP link with SIM and NFC chipset.</td>
      <td><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_test_mode_on test_mode_on;</code></td>
      <td>Changes the NFC chip to test mode. (Test mode exists only in the NXP case. If there are none, it does not need to implemented.)</td>
      <td><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_test_mode_off test_mode_off;</code></td>
      <td>Changes the status of the NFC chip from test mode to normal mode. (Test mode exists only in the NXP case. If there are none, it does not need to implemented.)</td>
      <td><code class="highlighter-rouge">net_nfc_error_e</code>: Returns an error code on failure</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">net_nfc_oem_controller_support_nfc support_nfc</code></td>
      <td>Checks each device file of each chip.</td>
      <td>-</td>
    </tr>
  </tbody>
</table>

<h3 id="configuration-1">Configuration</h3>

<p>The <code class="highlighter-rouge">nfc-plugin</code> package must be saved to the <code class="highlighter-rouge">/usr/lib/libnfc-plugin.so</code> directory when installed. When the <code class="highlighter-rouge">nfc-manager</code> starts, it looks for the plugin library and loads it dynamically from this path.</p>

<h3 id="references-2">References</h3>

<p>Enable the following configuration options in the kernel <code class="highlighter-rouge">.config</code> file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Using Pn544: CONFIG_PN544_NFC
Using Pn65n: CONFIG_PN65N_NFC
</code></pre></div></div>

<p>API references are available in the <a href="https://wiki.tizen.org/Tizen_3.0_Porting_Guide#Appendix_2">Tizen 3.0 Porting Guide appendix</a>.</p>

<p>For more information, see <a href="http://nfc-forum.org/">http://nfc-forum.org/</a>.</p>

<h2 id="mtp">MTP</h2>
<p>The Media Transfer Protocol (MTP) is used for exchanging media files between 2 devices:</p>

<ul>
  <li>MTP exchanges can only occur between 2 devices at a time.</li>
  <li>In each communication, 1 devices acts as the initiator and the other as the responder.</li>
  <li>
    <p>The initiator is the device that initiates actions with the responder by sending operations to the responder.</p>

    <p><strong>Figure: MTP Initiator</strong></p>

    <p><img src="media/800px-mtp-initiator.png" alt="MTP Initiator" /></p>
  </li>
  <li>
    <p>The responder cannot initiate any actions, and can only send responses to operations sent by the initiator or send events.</p>

    <p><strong>Figure: MTP Responder</strong></p>

    <p><img src="media/800px-mtp-responder.png" alt="MTP Responder" /></p>
  </li>
  <li>In the Tizen system, the USB host is the initiator, and the USB device is the responder.</li>
</ul>

<h3 id="porting-the-oal-interface-3">Porting the OAL Interface</h3>

<p>The Tizen MTP initiator and responder do not have an OAL Interface. There are extension possibilities for the MTP Transport layer.</p>

<h3 id="configuration-2">Configuration</h3>

<p>The following configuration is needed:</p>

<ul>
  <li>MTP initiator
    <ul>
      <li>The MTP Initiator consists of 3 packages:
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mtp-initiator daemon
mtp-initiator api
libmtp opensource
</code></pre></div>        </div>
      </li>
      <li>The MTP initiator does not operate independently. It requires the help of another module, such as USB.</li>
      <li>When the USB device is connected to the host, the module must run the MTP initiator daemon.</li>
    </ul>
  </li>
  <li>MTP responder
    <ul>
      <li>The MTP responder consists of 1 package:
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mtp-responder daemon
</code></pre></div>        </div>
      </li>
      <li>The MTP responder does not operate independently. It requires the help of another module, such as USB.</li>
      <li>When the USB device is connected to the host, the module must run the MTP responder daemon.</li>
    </ul>
  </li>
</ul>

<h3 id="references-3">References</h3>

<ul>
  <li>Media Transfer Protocol v.1.1 Spec: <a href="http://www.usb.org/developers/docs/devclass_docs/">http://www.usb.org/developers/docs/devclass_docs/</a></li>
</ul>

						</section>
					</main>
					<nav class="col-nav">
						<div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
						    


<div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
        
        
        
        
    
        <li>
            <a 
                href="platform/about/work-flow/" 
                data-target="#item1" 
                data-toggle="collapse" 
                data-parent="#stacked-menu"
                aria-expanded=" false "
                class=" collapsed "
                >
                    Platform Overview
                    <span class="caret arrow"></span>
            </a>
            

            
            <ul class="nav collapse" aria-expanded="false" id="#item1">
            

                
                <li>
                    
                    
                    <a 
                        href="platform/about/work-flow/" 
                        class=""
                        >
                        Platform Development Workflow
                    </a>
                    
                </li>
                
                <li>
                    
                    
                    <a 
                        href="platform/about/git-repo-structure/" 
                        class=""
                        >
                        Platform Git Repository Structure
                    </a>
                    
                </li>
                
                <li>
                    
                    
                    <a 
                        href="platform/about/conventions/" 
                        class=""
                        >
                        Typographic Conventions
                    </a>
                    
                </li>
                
            </ul>
            
        </li>
    
        
        
        
    
        <li>
            <a 
                href="platform/developing/installing/" 
                data-target="#item2" 
                data-toggle="collapse" 
                data-parent="#stacked-menu"
                aria-expanded=" false "
                class=" collapsed "
                >
                    Platform Developing
                    <span class="caret arrow"></span>
            </a>
            

            
            <ul class="nav collapse" aria-expanded="false" id="#item2">
            

                
                <li>
                    
                    
                    <a 
                        href="platform/developing/installing/" 
                        class=""
                        >
                        Installing Development Tools
                    </a>
                    
                </li>
                
                <li>
                    
                    
                    <a 
                        href="platform/developing/setting-up/" 
                        class=""
                        >
                        Setting up Development Environment
                    </a>
                    
                </li>
                
                <li>
                    
                    
                    <a 
                        href="platform/developing/cloning/" 
                        class=""
                        >
                        Cloning Tizen Source Files
                    </a>
                    
                </li>
                
                <li>
                    
                    
                    <a 
                        href="platform/developing/building/" 
                        class=""
                        >
                        Building Packages Locally with GBS
                    </a>
                    
                </li>
                
                <li>
                    
                    
                    <a 
                        href="platform/developing/building-all/" 
                        class=""
                        >
                        Building All Packages Locally with GBS
                    </a>
                    
                </li>
                
                <li>
                    
                    
                    <a 
                        href="platform/developing/contributing/" 
                        class=""
                        >
                        Contributing Code to Tizen
                    </a>
                    
                </li>
                
                <li>
                    
                    
                    <a 
                        href="platform/developing/creating/" 
                        class=""
                        >
                        Creating Tizen Images with MIC
                    </a>
                    
                </li>
                
                <li>
                    
                    
                    <a 
                        href="platform/developing/flashing/" 
                        class=""
                        >
                        Flashing an Image to Device
                    </a>
                    
                </li>
                
                <li>
                    
                    
                    <a 
                        href="platform/developing/tips/" 
                        class=""
                        >
                        Development Tips
                    </a>
                    
                </li>
                
            </ul>
            
        </li>
    
        
        
        
    
        <li>
            <a 
                href="platform/porting/overview/" 
                data-target="#item3" 
                data-toggle="collapse" 
                data-parent="#stacked-menu"
                aria-expanded=" true "
                class=" not-collapsed "
                >
                    Porting
                    <span class="caret arrow"></span>
            </a>
            

            
            <ul class="nav collapse in" aria-expanded="true" id="#item3">
            

                
                <li>
                    
                    
                    <a 
                        href="platform/porting/overview/" 
                        class=""
                        >
                        Overview
                    </a>
                    
                </li>
                
                <li>
                    
                    
                    <a 
                        href="platform/porting/kernel/" 
                        class=""
                        >
                        Kernel
                    </a>
                    
                </li>
                
                <li>
                    
                    
                    <a 
                        href="platform/porting/system/" 
                        class=""
                        >
                        System
                    </a>
                    
                </li>
                
                <li>
                    
                    
                    <a 
                        href="platform/porting/graphics-and-ui/" 
                        class=""
                        >
                        Graphics and UI
                    </a>
                    
                </li>
                
            </ul>
            
        </li>
    
        
        
        
    
        <li>
            <a 
                href="platform/reference/gerrit-usage" 
                data-target="#item4" 
                data-toggle="collapse" 
                data-parent="#stacked-menu"
                aria-expanded=" false "
                class=" collapsed "
                >
                    Reference
                    <span class="caret arrow"></span>
            </a>
            

            
            <ul class="nav collapse" aria-expanded="false" id="#item4">
            

                
                <li>
                    
                    
                    <a 
                        href="platform/reference/gerrit-usage/" 
                        class=""
                        >
                        Gerrit
                    </a>
                    
                </li>
                
                <li>
                    
                    
                    <a 
                        href="platform/reference/gbs/gbs-overview/"
                        class=""
                        aria-expanded=" false "
                        data-target="#item2" 
                        data-toggle="collapse" 
                        >
                        Git Build System (GBS)
                        <span class="caret arrow"></span>
                    </a>
                    
                    
                    <ul class="nav collapse" aria-expanded="false" id="#item2">
                    
                        
                        <li>
                            
                            <a 
                                href="platform/reference/gbs/gbs-overview/"
                                class=""
                                >
                                Overview
                            </a>
                        </li>
                        
                        <li>
                            
                            <a 
                                href="platform/reference/gbs/gbs.conf/"
                                class=""
                                >
                                GBS Configuration
                            </a>
                        </li>
                        
                        <li>
                            
                            <a 
                                href="platform/reference/gbs/gbs-maintenance-models/"
                                class=""
                                >
                                GBS Maintenance Models
                            </a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                <li>
                    
                    
                    <a 
                        href="platform/reference/mic/mic-overview/"
                        class=""
                        aria-expanded=" false "
                        data-target="#item3" 
                        data-toggle="collapse" 
                        >
                        MIC Image Creator
                        <span class="caret arrow"></span>
                    </a>
                    
                    
                    <ul class="nav collapse" aria-expanded="false" id="#item3">
                    
                        
                        <li>
                            
                            <a 
                                href="platform/reference/mic/mic-overview/"
                                class=""
                                >
                                Overview
                            </a>
                        </li>
                        
                        <li>
                            
                            <a 
                                href="platform/reference/mic/mic-customize-image/"
                                class=""
                                >
                                Customizing Images
                            </a>
                        </li>
                        
                        <li>
                            
                            <a 
                                href="platform/reference/mic/mic-reference/"
                                class=""
                                >
                                MIC Reference
                            </a>
                        </li>
                        
                    </ul>
                    
                </li>
                
            </ul>
            
        </li>
    
        
        
    </ul>
</div>
<script>
    $("a[href$='/platform/porting/connectivity/']").addClass("active currentPage");
</script>
						</div>
					</nav>
					<div class="col-toc">
						<div class="sidebar hidden-xs hidden-sm">
							<div class="toc-nav">
								<div class="feedback-links">
									<ul>
										
                                        <li style="visibility: hidden">
                                            <a href="">
                                                <i class="fa fa-pencil-square-o" aria-hidden="true"></i> 
                                                Edit this page
                                            </a>
                                        </li>
                                        
										<li>
                                            <a href="https://github.com/samsung-test/samsung-test.github.io/edit/1.1/platform/porting/connectivity.md" target="_blank">
                                                <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                                                Edit Page
                                            </a>
                                        </li>
                                        <li>
                                            <a href="https://github.com/samsung-test/samsung-test.github.io/issues/new" class="nomunge" target="_blank">
                                                <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
                                                Report Issue
                                            </a>
                                        </li>
									</ul>
								</div>
								   
									<div id="side-toc-title">On this page:</div>
									
<ul id="my_toc" class="inline_toc">
  <li><a href="#bluetooth" class="nomunge">Bluetooth</a>
    <ul>
      <li><a href="#porting-the-oal-interface" class="nomunge">Porting the OAL Interface</a></li>
      <li><a href="#configuration" class="nomunge">Configuration</a></li>
      <li><a href="#references" class="nomunge">References</a></li>
    </ul>
  </li>
  <li><a href="#wlan" class="nomunge">WLAN</a>
    <ul>
      <li><a href="#porting-the-oal-interface-1" class="nomunge">Porting the OAL Interface</a></li>
      <li><a href="#references-1" class="nomunge">References</a></li>
    </ul>
  </li>
  <li><a href="#nfc" class="nomunge">NFC</a>
    <ul>
      <li><a href="#porting-the-oal-interface-2" class="nomunge">Porting the OAL Interface</a></li>
      <li><a href="#configuration-1" class="nomunge">Configuration</a></li>
      <li><a href="#references-2" class="nomunge">References</a></li>
    </ul>
  </li>
  <li><a href="#mtp" class="nomunge">MTP</a>
    <ul>
      <li><a href="#porting-the-oal-interface-3" class="nomunge">Porting the OAL Interface</a></li>
      <li><a href="#configuration-2" class="nomunge">Configuration</a></li>
      <li><a href="#references-3" class="nomunge">References</a></li>
    </ul>
  </li>
</ul>


								</div>
								
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
    <div class="container-fluid">
  <div class="top_footer">
    <div class="footer-nav">
      <nav class="footer_sub_nav">
        <ul class="menu">
          <li><a href="https://developer.tizen.org/">Developer</a></li>
          <li><a href="https://dashboard.tizen.org/">Dashboard</a></li>
          <li><a href="https://craftroom.tizen.org/">Craftroom</a></li>
        </ul>
      </nav>
    </div>
  </div>
  <div class="bottom_footer">
    <div class="footer-copyright col-xs-12 col-md-8">
      <p class="copyright">
        Copyright &copy; 2019 Tizen Inc. All rights reserved.
      </p>
    </div>
    <div class="footer_social_nav">
      <ul class="nav-social">
        <li class="fa fa-github"><a href="https://github.com/samsung-test">GitHub</a></li>  
        <li class="fa fa-twitter"><a href="https://twitter.com/TizenProject">Twitter</a></li>
        <li class="fa fa-facebook"><a href="http://www.facebook.com/pages/Tizen-Project">Facebook</a></li>
      </ul>
    </div>
  </div>
</div>

    <div id="templates"></div>
    <script type="text/javascript" src="/js/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/js/common.js?v=08122019"></script>
<script type="text/javascript" src="/js/handlebars-v4.0.11.js?v=08122019"></script>
<script type="text/javascript" src="/js/widgets-data.js?v=08122019"></script>
<script type="text/javascript" src="/js/widgets.js?v=08122019"></script>
<script type="text/javascript" src="/js/highlight.pack.js"></script>
<script type="text/javascript" src="/js/tocs.js"></script>
<script type="text/javascript" src="/js/menu.js"></script>
<script type="text/javascript" src="/js/stickyfill.min.js"></script>
<script type="text/javascript" src="/js/metadata.js"></script>
<script type="text/javascript" src="/js/docs.js"></script>
</body>
</html>
